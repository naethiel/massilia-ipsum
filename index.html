<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="styles.css" />
    <title>Massilia Ipsum</title>
    <script>
      async function handleSubmit(e) {
        e.preventDefault();

        await getSentences();
      }

      async function getSentences() {
        const content = await generate();

        const container = document.querySelector("#output");

        container.innerHTML = "";

        content.data.forEach(paragraph => {
          let p = document.createElement("p");
          p.innerHTML = paragraph;

          container.appendChild(p);
        });
      }

      async function generate() {
        const FD = new FormData(document.querySelector("#form"));

        try {
          return await fetch(
            `http://localhost:8080/generate?length=${FD.get(
              "length"
            )}&size=${FD.get("size")}`
          ).then(r => r.json());
        } catch (err) {
          console.error(err);
        }
      }

      window.addEventListener("load", async function() {
        await getSentences();
      });
    </script>
  </head>
  <body>
    <header>
      <div class="container">
        <img src="assets/soleil.svg" alt="soleil" id="sun" />
        <h1>
          <img
            src="assets/logo.svg"
            alt="massilia ipsum, le générateur de lorem ipsum qui sent bon le pastaga"
          />
        </h1>
        <form onsubmit="handleSubmit(event)" id="form">
          <div id="quantity-input">
            <label for="length">Combien de paragraphes ?</label>
            <input type="number" name="length" value="5" />
          </div>
          <div id="size-input">
            <input type="radio" name="size" value="small" />
            <label for="small">petit</label>
            <input type="radio" name="size" value="medium" checked />
            <label for="medium">moyen</label>
            <input type="radio" name="size" value="large" />
            <label for="large">grand</label>
          </div>
          <button type="submit">Générer</button>
        </form>
        <img src="assets/gabian.svg" alt="gabian" id="seagull" />
      </div>
    </header>
    <section>
      <div class="container" id="ipsum-wrapper">
        <img
          src="assets/gobi-line.svg"
          alt="poissons"
          class="sea-life"
          id="fishs-1"
        />
        <img
          src="assets/gobi-3.svg"
          alt="poissons"
          class="sea-life"
          id="fishs-2"
        />
        <img
          src="assets/gobi-2.svg"
          alt="poissons"
          class="sea-life"
          id="fishs-3"
        />
        <img
          src="assets/kraken.svg"
          alt="kraken"
          class="sea-life"
          id="kraken"
        />
        <div id="output"></div>
      </div>
    </section>
    <footer>
      <img src="assets/pastaga.svg" alt="pastaga" />
      <p>
        Code par Nico - Design par KA
      </p>
    </footer>
  </body>
</html>
